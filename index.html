==================== index.html ====================
<!DOCTYPE html>
<html lang="bn">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Earn Bot</title>

<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script src='//libtl.com/sdk.js' data-zone='10420496' data-sdk='show_10420496'></script>

<style>
body{margin:0;font-family:sans-serif;background:#f1f5f9}
.header{background:#0f172a;color:#fff;padding:15px}
.card{background:#fff;margin:12px;padding:15px;border-radius:15px}
.btn{background:#22c55e;color:#fff;padding:14px;text-align:center;
border-radius:12px;font-weight:bold}
.menu{position:fixed;bottom:0;left:0;right:0;display:flex;
background:#fff;border-top:1px solid #ddd}
.menu div{flex:1;padding:12px;text-align:center}
.hidden{display:none}
</style>
</head>

<body>
<div class="header">
<b id="name"></b><br>
ID: <span id="uid"></span>
</div>

<div id="dash" class="card">
‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡ßá‡¶®‡ßç‡¶∏: ‡ß≥ <b id="balance">0</b><br>
‡¶∞‡ßá‡¶´‡¶æ‡¶∞: <b id="refer">0</b><br>
‡¶Ü‡¶ú‡¶ï‡ßá‡¶∞ ‡¶è‡¶°: <b id="ads">0</b>/100
<br><br>
<div class="btn" onclick="showAd()">‡¶è‡¶° ‡¶¶‡ßá‡¶ñ‡ßÅ‡¶®</div>
</div>

<div id="withdraw" class="card hidden">
<input id="method" placeholder="Bkash/Nagad" style="width:100%;padding:10px"><br><br>
<input id="number" placeholder="‡¶®‡¶æ‡¶Æ‡ßç‡¶¨‡¶æ‡¶∞" style="width:100%;padding:10px"><br><br>
<input id="amount" placeholder="‡¶è‡¶Æ‡¶æ‡¶â‡¶®‡ßç‡¶ü" style="width:100%;padding:10px"><br><br>
<div class="btn" onclick="withdrawReq()">‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞</div>
<p id="msg"></p>
</div>

<div class="menu">
<div onclick="openTab('dash')">‡¶°‡ßç‡¶Ø‡¶æ‡¶∂‡¶¨‡ßã‡¶∞‡ßç‡¶°</div>
<div onclick="openTab('withdraw')">‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞</div>
</div>

<script>
let tg=Telegram.WebApp;tg.expand();
let u=tg.initDataUnsafe.user;
uid.innerText=u.id;
name.innerText=u.username||u.first_name;

window.monetag=window.monetag||{};
window.monetag.subid=u.id.toString();

fetch("api.php?uid="+u.id)
.then(r=>r.json()).then(d=>{
 balance.innerText=d.balance;
 refer.innerText=d.refer;
 ads.innerText=d.ads;
});

function showAd(){
 if(typeof show_10420496==="function") show_10420496();
}

function withdrawReq(){
 let f=new FormData();
 f.append("uid",u.id);
 f.append("method",method.value);
 f.append("number",number.value);
 f.append("amount",amount.value);
 fetch("withdraw.php",{method:"POST",body:f})
 .then(r=>r.text()).then(t=>msg.innerText=t);
}

function openTab(id){
 dash.classList.add("hidden");
 withdraw.classList.add("hidden");
 document.getElementById(id).classList.remove("hidden");
}
</script>
</body>
</html>


==================== api.php ====================
<?php
$db=new mysqli("localhost","DB_USER","DB_PASS","DB_NAME");
$uid=intval($_GET['uid']);
$today=date("Y-m-d");

$db->query("INSERT IGNORE INTO users (telegram_id) VALUES ($uid)");

$u=$db->query("SELECT balance,refer_count FROM users WHERE telegram_id=$uid")->fetch_assoc();
$a=$db->query("SELECT COUNT(*) c FROM ad_logs WHERE telegram_id=$uid AND ad_date='$today'")->fetch_assoc();

echo json_encode([
 "balance"=>$u['balance'],
 "refer"=>$u['refer_count'],
 "ads"=>$a['c']
]);


==================== postback.php ====================
<?php
$db=new mysqli("localhost","DB_USER","DB_PASS","DB_NAME");
$uid=intval($_GET['subid']??0);
$amount=floatval($_GET['amount']??0);
if($uid<=0||$amount<=0)exit;

$today=date("Y-m-d");
$c=$db->query("SELECT COUNT(*) c FROM ad_logs WHERE telegram_id=$uid AND ad_date='$today'")->fetch_assoc();
if($c['c']>=100)exit;

$db->query("INSERT INTO ad_logs (telegram_id,ad_date) VALUES ($uid,'$today')");
$db->query("INSERT IGNORE INTO users (telegram_id) VALUES ($uid)");
$db->query("UPDATE users SET balance=balance+$amount,total_earn=total_earn+$amount WHERE telegram_id=$uid");
echo "OK";


==================== withdraw.php ====================
<?php
$db=new mysqli("localhost","DB_USER","DB_PASS","DB_NAME");
$uid=intval($_POST['uid']);
$amount=floatval($_POST['amount']);

$u=$db->query("SELECT balance,refer_count FROM users WHERE telegram_id=$uid")->fetch_assoc();
if($u['balance']<1500)exit("‚ùå ‡¶Æ‡¶ø‡¶®‡¶ø‡¶Æ‡¶æ‡¶Æ ‡ßß‡ß´‡ß¶‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ");
if($u['refer_count']<5)exit("‚ùå ‡¶Æ‡¶ø‡¶®‡¶ø‡¶Æ‡¶æ‡¶Æ ‡ß´ ‡¶∞‡ßá‡¶´‡¶æ‡¶∞");

$db->query("INSERT INTO withdraws (telegram_id,method,number,amount)
VALUES ($uid,'{$_POST['method']}','{$_POST['number']}',$amount)");
$db->query("UPDATE users SET balance=balance-$amount WHERE telegram_id=$uid");
echo "‚úÖ ‡¶â‡¶á‡¶•‡¶°‡ßç‡¶∞ ‡¶∞‡¶ø‡¶ï‡ßÅ‡ßü‡ßá‡¶∏‡ßç‡¶ü ‡¶™‡¶æ‡¶†‡¶æ‡¶®‡ßã ‡¶π‡ßü‡ßá‡¶õ‡ßá";


==================== bot.php ====================
<?php
$token="8061432379:AAHuwEJCYafxuR8ju4MkaEIP4inOyuGnpk0";
$api="https://api.telegram.org/bot$token/";
$db=new mysqli("localhost","DB_USER","DB_PASS","DB_NAME");

$u=json_decode(file_get_contents("php://input"),true);
$m=$u['message']??null;
if(!$m)exit;

$uid=$m['chat']['id'];
$text=$m['text']??"";

$db->query("INSERT IGNORE INTO users (telegram_id) VALUES ($uid)");

if(strpos($text,"/start")===0){
 $p=explode(" ",$text);
 if(isset($p[1])){
  $db->query("UPDATE users SET referred_by={$p[1]} WHERE telegram_id=$uid AND referred_by IS NULL");
  $db->query("UPDATE users SET refer_count=refer_count+1 WHERE telegram_id={$p[1]}");
 }
 file_get_contents($api."sendMessage?chat_id=$uid&text=üéâ Earn Bot Ready");
}


==================== db.sql ====================
CREATE TABLE users (
 id INT AUTO_INCREMENT PRIMARY KEY,
 telegram_id BIGINT UNIQUE,
 balance DOUBLE DEFAULT 0,
 total_earn DOUBLE DEFAULT 0,
 refer_count INT DEFAULT 0,
 referred_by BIGINT DEFAULT NULL
);

CREATE TABLE ad_logs (
 id INT AUTO_INCREMENT PRIMARY KEY,
 telegram_id BIGINT,
 ad_date DATE
);

CREATE TABLE withdraws (
 id INT AUTO_INCREMENT PRIMARY KEY,
 telegram_id BIGINT,
 method VARCHAR(20),
 number VARCHAR(20),
 amount DOUBLE,
 status VARCHAR(20) DEFAULT 'PENDING',
 created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);


==================== admin/config.php ====================
<?php
session_start();
$db=new mysqli("localhost","DB_USER","DB_PASS","DB_NAME");
$ADMIN_USER="admin";
$ADMIN_PASS="123456";


==================== admin/login.php ====================
<?php require "config.php"; ?>
<form method="post">
<input name="user">
<input name="pass" type="password">
<button>Login</button>
<?php
if($_POST){
 if($_POST['user']==$ADMIN_USER && $_POST['pass']==$ADMIN_PASS){
  $_SESSION['admin']=1; header("Location: dashboard.php");
 } else echo "Wrong";
}
?>
</form>


==================== admin/dashboard.php ====================
<?php require "config.php"; if(!isset($_SESSION['admin']))exit; ?>
<a href="users.php">Users</a> |
<a href="withdraws.php">Withdraws</a>


==================== admin/users.php ====================
<?php require "config.php";
$r=$db->query("SELECT telegram_id,balance FROM users");
while($u=$r->fetch_assoc()){
 echo $u['telegram_id']." | ".$u['balance']."<br>";
}


==================== admin/withdraws.php ====================
<?php require "config.php";
$r=$db->query("SELECT * FROM withdraws");
while($w=$r->fetch_assoc()){
 echo $w['telegram_id']." | ".$w['amount']." | ".$w['status']."<br>";
}
